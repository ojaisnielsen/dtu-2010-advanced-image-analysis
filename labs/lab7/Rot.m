function [R,dR]=Rot(V);

c=cos(V);
s=sin(V);

R=zeros(3,3);

R(1,1)=c(2)*c(3);
R(2,1)=-c(2)*s(3);
R(3,1)=s(2);
R(1,2)=c(1)*s(3)+s(1)*s(2)*c(3);
R(2,2)=c(1)*c(3)-s(1)*s(2)*s(3);
R(3,2)=-s(1)*c(2);
R(1,3)=s(1)*s(3)-c(1)*s(2)*c(3);
R(2,3)=s(1)*c(3)+c(1)*s(2)*s(3);
R(3,3)=c(1)*c(2);

dR=zeros(3,3,3);

dR(1,1,1)=0;
dR(2,1,1)=0;
dR(3,1,1)=0;
dR(1,2,1)=-s(1)*s(3)+c(1)*s(2)*c(3);
dR(2,2,1)=-s(1)*c(3)-c(1)*s(2)*s(3);
dR(3,2,1)=-c(1)*c(2);
dR(1,3,1)=c(1)*s(3)+s(1)*s(2)*c(3);
dR(2,3,1)=c(1)*c(3)-s(1)*s(2)*s(3);
dR(3,3,1)=-s(1)*c(2);

dR(1,1,2)=-s(2)*c(3);
dR(2,1,2)=s(2)*s(3);
dR(3,1,2)=c(2);
dR(1,2,2)=s(1)*c(2)*c(3);
dR(2,2,2)=-s(1)*c(2)*s(3);
dR(3,2,2)=s(1)*s(2);
dR(1,3,2)=-c(1)*c(2)*c(3);
dR(2,3,2)=c(1)*c(2)*s(3);
dR(3,3,2)=-c(1)*s(2);

dR(1,1,3)=-c(2)*s(3);
dR(2,1,3)=-c(2)*c(3);
dR(3,1,3)=0;
dR(1,2,3)=c(1)*c(3)-s(1)*s(2)*s(3);
dR(2,2,3)=-c(1)*s(3)-s(1)*s(2)*c(3);
dR(3,2,3)=0;
dR(1,3,3)=s(1)*c(3)+c(1)*s(2)*s(3);
dR(2,3,3)=-s(1)*s(3)+c(1)*s(2)*c(3);
dR(3,3,3)=0;
